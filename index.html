<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elige tu propia experiencia</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FDF0D5;
            --primary-color: #C6D8D3;
            --secondary-color: #F05941;
            --accent-color: #5EAAA8;
            --text-color: #333333;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            /* CAMBIO CLAVE: Se eliminan las propiedades flex para un control más simple */
        }

        .game-container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            border-radius: 20px;
            padding: 30px 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.5s ease;
            /* CAMBIO CLAVE: 'auto' centra horizontalmente y 5vh da margen arriba y abajo */
            margin: 5vh auto; 
        }
        
        .game-title {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }

        .game-text {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .final-emoji {
            font-size: 5rem;
            display: block;
            margin-bottom: 20px;
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-button {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-bottom: 4px solid rgba(0,0,0,0.2);
        }

        .choice-button:hover {
            transform: translateY(-3px);
            background-color: var(--secondary-color);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .choice-button:active {
            transform: translateY(0);
            border-bottom-width: 2px;
        }
        
        .start-button, #send-whatsapp-btn {
             background-color: var(--secondary-color);
        }
        #send-whatsapp-btn {
            margin-top: 20px;
        }

        #feedback-message {
            margin-top: 20px;
            font-weight: 600;
            color: var(--secondary-color);
            opacity: 0;
            transition: opacity 0.3s ease;
            min-height: 24px;
        }
        
        /* Estilos del Calendario */
        .calendar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
        }
        .month {
            width: 100%;
            max-width: 300px;
            background-color: #f7f7f7;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }
        .month h3 {
            font-size: 1.4rem;
            color: var(--accent-color);
            margin-bottom: 15px;
        }
        .weekdays, .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        .weekday-item, .day-item {
            padding: 8px 0;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .day-item {
            background-color: #fff;
            color: var(--text-color);
            border: 1px solid #ddd;
        }
        .day-item.empty {
            background-color: transparent;
            border: none;
            cursor: default;
        }
        .day-item.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .day-item:not(.empty):hover {
            background-color: var(--secondary-color);
            color: white;
        }
        .instructions-final {
            margin-top: 20px;
            font-size: 1.1rem;
            color: var(--accent-color);
            font-weight: 600;
        }


        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .game-container {
                padding: 20px;
                margin: 2vh auto;
            }
            .game-title {
                font-size: 2rem;
            }
            .game-text {
                font-size: 1rem;
            }
            .choice-button {
                font-size: 1rem;
                padding: 12px 15px;
            }
            .month h3 {
                font-size: 1.2rem;
            }
            .weekday-item, .day-item {
                font-size: 0.8rem;
                padding: 6px 0;
            }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1 id="game-title" class="game-title">Título del Juego</h1>
        <p id="game-text" class="game-text">Texto de la situación...</p>
        <div id="choices-container" class="choices-container">
            </div>
        <div id="calendar-view" class="calendar-container" style="display: none;">
            
        </div>
        <div id="feedback-message"></div>
    </div>

    <script>
        // --- ELEMENTOS DEL JUEGO ---
        const gameTitleEl = document.getElementById('game-title');
        const gameTextEl = document.getElementById('game-text');
        const choicesContainerEl = document.getElementById('choices-container');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const calendarViewEl = document.getElementById('calendar-view');

        let selectedDates = []; 
        let userChoices = {}; 

        // --- CEREBRO DEL JUEGO: Aquí está toda la historia y las decisiones ---
        const gameData = [
            // Pantalla 0: Introducción
            {
                type: 'intro',
                title: 'Elige tu propia experiencia',
                text: 'A ver, Sibila. Llegó tu hora. Sabes cómo funciona esto. Es el "Año de las Experiencias" y, como toda Siniestra, no vas a zafar, tu turno en el calendario ha sido marcado. Pero en este caso, las Siniestras han decidido que tú tienes "coronita". Sí, leíste bien. Después de tanto organizar para las demás, vos vas a tener el poder de guiar ALGUNAS COSAS de tu propia experiencia, a partir de como resuelvas las siguientes situaciones…',
                choices: [{ text: 'Que empiece la tortura...', target: 1 }]
            },
            // Pantalla 1: Situación #1
            {
                type: 'choice',
                title: 'SITUACIÓN #1',
                text: 'Después de una semana larguísima, llegas a tu casa y descubres una puerta que nunca antes habías visto. La abres y en el centro hay algo que te llama la atención. ¿Qué es?',
                choices: [
                    { text: 'Una bola de espejos escuchando "aaaay nena..."', target: 2, keyword: 'un poco de fiesta' },
                    { text: 'Un sillón que susurra "sentate y contá todo..."', target: 2, keyword: 'mucha charla' },
                    { text: 'Un jacuzzi y un masaje facial en absoluto silencio', target: 2, keyword: 'bastante relax' }
                ]
            },
            // Pantalla 2: Situación #2
            {
                type: 'choice',
                title: 'SITUACIÓN #2',
                text: 'Estás en medio de un sueño rarísimo. Te persigue algo (podría ser la boleta de UTE). Llegas al borde de un acantilado. ¿Qué haces?',
                choices: [
                    { text: 'Correr a la velocidad de la luz por el borde', target: 3, keyword: 'escapar de todo' },
                    { text: 'Saltar al vacío y empezar a volar', target: 3, keyword: 'experimentar sin miedo' },
                    { text: 'Zambullirte en el mar y nadar...', target: 3, keyword: 'entregarme a la situación' }
                ]
            },
            // Pantalla 3: Situación #3
            {
                type: 'choice',
                title: 'SITUACIÓN #3',
                text: 'Una botella llega a la orilla. Adentro hay un papelito que dice: "Sé tu secreto: sigues llevando la cuenta de quién no sabe pagar la luz, el agua y el gas". ¿Qué hacés?',
                choices: [
                    { text: 'Salir corriendo, ¡me han descubierto!', target: 4 },
                    { text: 'Escribir "ok, ahora contame uno tuyo" y devolverla', target: 4 },
                    { text: 'Pensar "alguien tiene que ser la adulta aquí"', target: 4 }
                ]
            },
            // Pantalla 4: Prueba de Actitud
            {
                type: 'choice',
                title: 'LA HORA DE LA VERDAD',
                text: 'Tus amigas idearon diversas experiencias, dependiendo de tu próxima respuesta y los resultados de este juego va a ser la definitiva.',
                choices: [
                    { text: 'Odio la experiencia, no cuenten conmigo.', target: 'error', message: 'Respuesta incorrecta. Reglamento Siniestro, Art. 3: "no zafa nadie".' },
                    { text: 'Yo ya dije exactamente lo que quiero, dejen de inventar.', target: 'error', message: 'Error. Tu "coronita" es para guiar, no para dar órdenes.' },
                    { text: 'Bua... claramente no voy a poder zafar... Por lo menos elijo la fecha...', target: 5 }
                ]
            },
            // Pantalla 5: ¡VERSIÓN CON CALENDARIO Y BOTÓN DE WHATSAPP!
            {
                type: 'calendar',
                title: 'TU AGENDA SINIESTRA',
                text: '¡Esa es la actitud! Has superado las pruebas. Ahora, con tu "coronita", selecciona en el calendario los días de Octubre y Noviembre en los que tendrías <strong>realmente disponibilidad</strong> para tu experiencia. Selecciona todos los que te sirvan.',
            }
        ];

        let currentScreen = 0;

        function renderScreen(screenIndex) {
            const screenData = gameData[screenIndex];
            const container = document.querySelector('.game-container');
            container.style.opacity = 0;

            setTimeout(() => {
                gameTitleEl.innerText = screenData.title;
                gameTextEl.innerHTML = screenData.text;
                choicesContainerEl.innerHTML = '';
                calendarViewEl.innerHTML = ''; 

                if (screenData.type === 'calendar') {
                    choicesContainerEl.style.display = 'none'; 
                    calendarViewEl.style.display = 'flex'; 
                    const currentYear = new Date().getFullYear();
                    renderCalendar(currentYear, 9); 
                    renderCalendar(currentYear, 10); 
                    
                    const whatsappButton = document.createElement('button');
                    whatsappButton.id = 'send-whatsapp-btn';
                    whatsappButton.className = 'choice-button';
                    whatsappButton.innerText = 'Confirmar y Enviar por WhatsApp';
                    calendarViewEl.appendChild(whatsappButton);
                    
                    whatsappButton.onclick = sendWhatsAppMessage;

                } else {
                    choicesContainerEl.style.display = 'flex'; 
                    calendarViewEl.style.display = 'none'; 
                    screenData.choices.forEach(choice => {
                        const button = document.createElement('button');
                        button.className = 'choice-button';
                        button.onclick = () => handleChoice(choice, screenIndex);
                        button.innerText = choice.text;
                        choicesContainerEl.appendChild(button);
                    });
                }
                
                container.style.opacity = 1;
            }, 300);
        }

        function handleChoice(choice, screenIndex) {
            if (choice.keyword) {
                userChoices[`situation${screenIndex}`] = choice.keyword;
            }

            if (choice.target === 'error') {
                feedbackMessageEl.innerText = choice.message;
                feedbackMessageEl.style.opacity = 1;
                setTimeout(() => {
                    feedbackMessageEl.style.opacity = 0;
                }, 3000);
            } else {
                currentScreen = choice.target;
                renderScreen(currentScreen);
            }
        }

        function renderCalendar(year, month) {
            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            const weekdays = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];
            const monthDiv = document.createElement('div');
            monthDiv.className = 'month';
            monthDiv.innerHTML = `<h3>${monthNames[month]} ${year}</h3>`;
            const weekdaysDiv = document.createElement('div');
            weekdaysDiv.className = 'weekdays';
            weekdays.forEach(day => {
                const weekdayItem = document.createElement('div');
                weekdayItem.className = 'weekday-item';
                weekdayItem.innerText = day;
                weekdaysDiv.appendChild(weekdayItem);
            });
            monthDiv.appendChild(weekdaysDiv);
            const daysDiv = document.createElement('div');
            daysDiv.className = 'days';
            const firstDay = new Date(year, month, 1).getDay();
            const numDays = new Date(year, month + 1, 0).getDate();
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'day-item empty';
                daysDiv.appendChild(emptyDay);
            }
            for (let day = 1; day <= numDays; day++) {
                const dayItem = document.createElement('div');
                dayItem.className = 'day-item';
                dayItem.innerText = day;
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                dayItem.dataset.date = dateStr;
                if (selectedDates.includes(dateStr)) {
                    dayItem.classList.add('selected');
                }
                dayItem.onclick = () => {
                    dayItem.classList.toggle('selected');
                    const dateIndex = selectedDates.indexOf(dateStr);
                    if (dateIndex > -1) {
                        selectedDates.splice(dateIndex, 1);
                    } else {
                        selectedDates.push(dateStr);
                    }
                };
                daysDiv.appendChild(dayItem);
            }
            monthDiv.appendChild(daysDiv);
            calendarViewEl.appendChild(monthDiv);
        }

        function sendWhatsAppMessage() {
            if (selectedDates.length === 0) {
                feedbackMessageEl.innerText = '¡No te olvides de seleccionar al menos una fecha!';
                feedbackMessageEl.style.opacity = 1;
                setTimeout(() => { feedbackMessageEl.style.opacity = 0; }, 3000);
                return;
            }

            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            const formattedDates = selectedDates.sort().map(dateStr => {
                const date = new Date(dateStr + 'T00:00:00');
                const day = date.getDate();
                const month = monthNames[date.getMonth()];
                return `${day} de ${month}`;
            });

            const choice1 = userChoices.situation1 || 'un poco de todo';
            const choice2 = userChoices.situation2 || 'lo que venga';

            let message = `Siniestras, acá su próxima víctima reportándose.\n\n`;
            message += `Después de superar el interrogatorio digital al que me sometieron, por la presente informo mi disponibilidad y entrega absoluta para la experiencia.\n\n`;
            message += `Como habrán visto en mis respuestas, pretendo ${choice1} y ${choice2}.\n\n`;
            message += `Mis posibles fechas son:\n`;
            formattedDates.forEach(date => {
                message += `- ${date}\n`;
            });
            message += `\nElijan sabiamente y eviten llamar a Guille...\n\n`;
            message += `Atentamente,\nSibi`;

            const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        }
        
        // Iniciar el juego
        renderScreen(currentScreen);
    </script>

</body>
</html>