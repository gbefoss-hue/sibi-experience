<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elige tu propia experiencia</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FDF0D5;
            --primary-color: #C6D8D3;
            --secondary-color: #F05941;
            --accent-color: #5EAAA8;
            --text-color: #333333;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .game-container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            border-radius: 20px;
            padding: 30px 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.5s ease;
            margin: 5vh auto; 
        }
        
        .game-title {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }

        .game-text {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-button {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-bottom: 4px solid rgba(0,0,0,0.2);
        }

        .choice-button:hover {
            transform: translateY(-3px);
            background-color: var(--secondary-color);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .choice-button:active {
            transform: translateY(0);
            border-bottom-width: 2px;
        }
        
        .start-button, #send-whatsapp-btn, #need-dates-btn {
             background-color: var(--secondary-color);
        }
        #need-dates-btn {
            background-color: #777;
        }

        #feedback-message {
            margin-top: 20px;
            font-weight: 600;
            color: var(--secondary-color);
            opacity: 0;
            transition: opacity 0.3s ease;
            min-height: 24px;
        }
        
        /* Estilos del Calendario */
        .calendar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
        }
        .month {
            width: 100%;
            max-width: 300px;
            background-color: #f7f7f7;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }
        .month h3 {
            font-size: 1.4rem;
            color: var(--accent-color);
            margin-bottom: 15px;
        }
        .weekdays, .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        .weekday-item, .day-item {
            padding: 8px 0;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
            background-color: #eee;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .day-item {
            background-color: #fff;
            color: var(--text-color);
            border: 1px solid #ddd;
        }
        .day-item.empty {
            background-color: transparent;
            border: none;
            cursor: default;
        }
        .day-item.disabled {
            background-color: #f0f0f0;
            color: #bbb;
            cursor: not-allowed;
            text-decoration: line-through;
        }
        .day-item.disabled:hover {
            background-color: #f0f0f0;
            color: #bbb;
        }
        .day-item.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .day-item:not(.empty):not(.disabled):hover {
            background-color: var(--secondary-color);
            color: white;
        }
        .final-buttons-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            width: 100%;
        }


        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .game-container {
                padding: 20px;
                margin: 2vh auto;
            }
            .game-title {
                font-size: 2rem;
            }
            .game-text {
                font-size: 1rem;
            }
            .choice-button {
                font-size: 1rem;
                padding: 12px 15px;
            }
            .month h3 {
                font-size: 1.2rem;
            }
            .weekday-item, .day-item {
                font-size: 0.8rem;
                padding: 6px 0;
            }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1 id="game-title" class="game-title">T√≠tulo del Juego</h1>
        <p id="game-text" class="game-text">Texto de la situaci√≥n...</p>
        <div id="choices-container" class="choices-container">
            </div>
        <div id="calendar-view" class="calendar-container" style="display: none;">
            
        </div>
        <div id="feedback-message"></div>
    </div>

    <script>
        // --- ELEMENTOS DEL JUEGO ---
        const gameTitleEl = document.getElementById('game-title');
        const gameTextEl = document.getElementById('game-text');
        const choicesContainerEl = document.getElementById('choices-container');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const calendarViewEl = document.getElementById('calendar-view');

        let selectedDates = new Set();
        let userChoices = {}; 

        // --- CEREBRO DEL JUEGO ---
        const gameData = [
            // Pantalla 0: Introducci√≥n
            {
                type: 'intro',
                title: 'Elige tu propia experiencia',
                text: 'A ver, Sibila. Lleg√≥ tu hora. Sabes c√≥mo funciona esto. Es el "A√±o de las Experiencias" y, como toda Siniestra, no vas a zafar, tu turno en el calendario ha sido marcado. Pero en este caso, las Siniestras han decidido que t√∫ tienes "coronita". S√≠, le√≠ste bien. Despu√©s de tanto ver sufrir a las dem√°s, vos vas a tener el poder de guiar ALGUNAS COSAS de tu propia experiencia, a partir de como resuelvas las siguientes situaciones‚Ä¶',
                choices: [{ text: 'Que empiece la tortura...', target: 1 }]
            },
            // Pantalla 1: Situaci√≥n #1
            {
                type: 'choice',
                title: 'SITUACI√ìN #1',
                text: 'Despu√©s de una semana largu√≠sima, de esas que te dejan el cerebro frito, llegas a tu casa y descubres una puerta que nunca antes hab√≠as visto en el living. La abres. El cuarto adentro es simple, pero en el centro hay algo que te llama poderosamente la atenci√≥n. ¬øQu√© es?',
                choices: [
                    { text: 'Una bola de espejos escuchando "aaaay nena, a tu cola le falta crema‚Ä¶"', target: 2, keyword: 'un poco de fiesta' },
                    { text: 'Un sill√≥n que susurra "sentate y cont√° todo, tenemos tiempo"', target: 2, keyword: 'mucha charla' },
                    { text: 'Un jacuzzi y un masaje facial en absoluto silencio', target: 2, keyword: 'bastante relax' }
                ]
            },
            // Pantalla 2: Situaci√≥n #2
            {
                type: 'choice',
                title: 'SITUACI√ìN #2',
                text: 'Est√°s en medio de un sue√±o rar√≠simo. Te persigue algo (podr√≠a ser la boleta de UTE). Llegas al borde de un acantilado alt√≠simo. Abajo, hay un mar de un color turquesa intenso. Tienes tres opciones para escapar. ¬øQu√© haces?',
                choices: [
                    { text: 'Correr a la velocidad de la luz por el borde', target: 3, keyword: 'escapar de todo' },
                    { text: 'Saltar al vac√≠o y empezar a volar', target: 3, keyword: 'experimentar sin miedo' },
                    { text: 'Zambullirte en el mar y nadar hacia una cueva', target: 3, keyword: 'entregarme a la situaci√≥n' }
                ]
            },
            // Pantalla 3: Situaci√≥n #3
            {
                type: 'choice',
                title: 'SITUACI√ìN #3',
                text: 'Una botella llega a la orilla. Adentro hay un papelito que dice: "S√© tu secreto: sigues llevando la cuenta de qui√©n no sabe pagar la luuu, el agua y el gas". ¬øQu√© hac√©s?',
                choices: [
                    { text: 'Salir corriendo, ¬°me han descubierto!', target: 4 },
                    { text: 'Escribir "ok, ahora contame uno tuyo" y devolverla', target: 4 },
                    { text: 'Pensar "alguien tiene que ser la adulta aqu√≠"', target: 4 }
                ]
            },
            // Pantalla 4: Prueba de Actitud
            {
                type: 'choice',
                title: 'LA HORA DE LA VERDAD',
                text: 'Tus amigas idearon diversas experiencias, dependiendo de tu pr√≥xima respuesta y los resultados de este juego va a ser la definitiva.',
                choices: [
                    { text: 'Odio la experiencia, no cuenten conmigo.', target: 'error', message: 'Respuesta incorrecta. Reglamento Siniestro, Art. 3: "no zafa nadie".' },
                    { text: 'Yo ya dije exactamente lo que quiero, dejen de inventar.', target: 'error', message: 'Error. Tu "coronita" es para guiar, no para dar √≥rdenes.' },
                    { text: 'Bua... claramente no voy a poder zafar... Por lo menos elijo la fecha...', target: 5 }
                ]
            },
            // Pantalla 5: Calendario
            {
                type: 'calendar',
                title: 'TU AGENDA SINIESTRA',
                text: '¬°Esa es la actitud! Has superado las pruebas. Ahora, con tu coronita, selecciona en el calendario los <strong>fines de semana</strong> de Octubre y Noviembre en los que tendr√≠as <strong>realmente disponibilidad</strong> para tu experiencia. Selecciona todos los que te sirvan.'
            }
        ];

        let currentScreen = 0;

        function renderScreen(screenIndex) {
            const screenData = gameData[screenIndex];
            const container = document.querySelector('.game-container');
            container.style.opacity = 0;

            setTimeout(() => {
                gameTitleEl.innerText = screenData.title;
                gameTextEl.innerHTML = screenData.text;
                choicesContainerEl.innerHTML = '';
                calendarViewEl.innerHTML = ''; 

                if (screenData.type === 'calendar') {
                    choicesContainerEl.style.display = 'none'; 
                    calendarViewEl.style.display = 'flex'; 
                    const currentYear = 2025;
                    renderCalendar(currentYear, 9);
                    renderCalendar(currentYear, 10);
                    
                    const buttonsContainer = document.createElement('div');
                    buttonsContainer.className = 'final-buttons-container';

                    const helpButton = document.createElement('button');
                    helpButton.id = 'need-dates-btn';
                    helpButton.className = 'choice-button';
                    helpButton.innerText = 'No puedo ninguno :(, necesito m√°s fechas';
                    buttonsContainer.appendChild(helpButton);

                    const whatsappButton = document.createElement('button');
                    whatsappButton.id = 'send-whatsapp-btn';
                    whatsappButton.className = 'choice-button';
                    whatsappButton.innerText = 'Confirmar y Enviar por WhatsApp';
                    buttonsContainer.appendChild(whatsappButton);
                    
                    calendarViewEl.appendChild(buttonsContainer);
                    
                    whatsappButton.onclick = sendWhatsAppMessage;
                    helpButton.onclick = sendHelpMessage;

                } else {
                    choicesContainerEl.style.display = 'flex'; 
                    calendarViewEl.style.display = 'none'; 
                    screenData.choices.forEach(choice => {
                        const button = document.createElement('button');
                        button.className = 'choice-button';
                        button.onclick = () => handleChoice(choice, screenIndex);
                        button.innerText = choice.text;
                        choicesContainerEl.appendChild(button);
                    });
                }
                container.style.opacity = 1;
            }, 300);
        }

        function handleChoice(choice, screenIndex) {
            if (choice.keyword) {
                userChoices[`situation${screenIndex}`] = choice.keyword;
            }
            if (choice.target === 'error') {
                feedbackMessageEl.innerText = choice.message;
                feedbackMessageEl.style.opacity = 1;
                setTimeout(() => { feedbackMessageEl.style.opacity = 0; }, 3000);
            } else {
                currentScreen = choice.target;
                renderScreen(currentScreen);
            }
        }

        function renderCalendar(year, month) {
            const monthNames = ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"];
            // ¬°NUEVO ORDEN DE D√çAS!
            const weekdays = ["Lun", "Mar", "Mi√©", "Jue", "Vie", "S√°b", "Dom"];
            const monthDiv = document.createElement('div');
            monthDiv.className = 'month';
            monthDiv.innerHTML = `<h3>${monthNames[month]} ${year}</h3>`;
            const weekdaysDiv = document.createElement('div');
            weekdaysDiv.className = 'weekdays';
            weekdays.forEach(day => {
                const weekdayItem = document.createElement('div');
                weekdayItem.className = 'weekday-item';
                weekdayItem.innerText = day;
                weekdaysDiv.appendChild(weekdayItem);
            });
            monthDiv.appendChild(weekdaysDiv);
            const daysDiv = document.createElement('div');
            daysDiv.className = 'days';
            
            // ¬°NUEVA L√ìGICA PARA EL PRIMER D√çA!
            const firstDayOfMonth = new Date(year, month, 1).getDay(); // Domingo=0, Lunes=1...
            // Ajustamos para que Lunes sea el primer d√≠a (√≠ndice 0)
            const daysToShift = (firstDayOfMonth === 0) ? 6 : firstDayOfMonth - 1;

            for (let i = 0; i < daysToShift; i++) {
                daysDiv.appendChild(document.createElement('div')).className = 'day-item empty';
            }
            
            const numDays = new Date(year, month + 1, 0).getDate();
            for (let day = 1; day <= numDays; day++) {
                const dayItem = document.createElement('div');
                dayItem.className = 'day-item';
                dayItem.innerText = day;
                const date = new Date(year, month, day);
                const dayOfWeek = date.getDay();
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                dayItem.dataset.date = dateStr;

                // Domingo es 0, S√°bado es 6
                if (dayOfWeek !== 6 && dayOfWeek !== 0) {
                    dayItem.classList.add('disabled');
                } else {
                    dayItem.onclick = () => handleWeekendClick(date);
                }
                
                if (selectedDates.has(dateStr)) {
                    dayItem.classList.add('selected');
                }
                daysDiv.appendChild(dayItem);
            }
            monthDiv.appendChild(daysDiv);
            calendarViewEl.appendChild(monthDiv);
        }

        function handleWeekendClick(date) {
            const dayOfWeek = date.getDay();
            let satDate, sunDate;

            if (dayOfWeek === 6) {
                satDate = date;
                sunDate = new Date(date);
                sunDate.setDate(date.getDate() + 1);
            } else {
                sunDate = date;
                satDate = new Date(date);
                satDate.setDate(date.getDate() - 1);
            }

            const satStr = `${satDate.getFullYear()}-${String(satDate.getMonth() + 1).padStart(2, '0')}-${String(satDate.getDate()).padStart(2, '0')}`;
            const sunStr = `${sunDate.getFullYear()}-${String(sunDate.getMonth() + 1).padStart(2, '0')}-${String(sunDate.getDate()).padStart(2, '0')}`;

            const satEl = document.querySelector(`[data-date="${satStr}"]`);
            const sunEl = document.querySelector(`[data-date="${sunStr}"]`);
            
            if (selectedDates.has(satStr)) {
                selectedDates.delete(satStr);
                selectedDates.delete(sunStr);
                if(satEl) satEl.classList.remove('selected');
                if(sunEl) sunEl.classList.remove('selected');
            } else {
                selectedDates.add(satStr);
                selectedDates.add(sunStr);
                if(satEl) satEl.classList.add('selected');
                if(sunEl) sunEl.classList.add('selected');
            }
        }

        function sendWhatsAppMessage() {
            if (selectedDates.size === 0) {
                feedbackMessageEl.innerText = '¬°No te olvides de seleccionar al menos un fin de semana!';
                feedbackMessageEl.style.opacity = 1;
                setTimeout(() => { feedbackMessageEl.style.opacity = 0; }, 3000);
                return;
            }

            const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
            const sortedDates = Array.from(selectedDates).sort();
            
            let formattedWeekends = [];
            for (let i = 0; i < sortedDates.length; i += 2) {
                const sat = new Date(sortedDates[i] + 'T00:00:00');
                const sun = new Date(sortedDates[i+1] + 'T00:00:00');
                // Comprobaci√≥n para evitar errores si las fechas no est√°n en el mismo mes
                const monthName = sat.getMonth() === sun.getMonth() ? monthNames[sat.getMonth()] : `${monthNames[sat.getMonth()]}/${monthNames[sun.getMonth()]}`;
                formattedWeekends.push(`${sat.getDate()} y ${sun.getDate()} de ${monthName}`);
            }

            const choice1 = userChoices.situation1 || 'un poco de todo';
            const choice2 = userChoices.situation2 || 'lo que venga';

            let message = `Siniestras, ac√° su pr√≥xima v√≠ctima report√°ndose.\n\n`;
            message += `Despu√©s de superar el interrogatorio digital al que me sometieron, por la presente informo mi disponibilidad y entrega absoluta para la experiencia.\n\n`;
            message += `Como habr√°n visto en mis respuestas, pretendo ${choice1} y ${choice2}.\n\n`;
            message += `Mis fines de semana posibles son:\n`;
            formattedWeekends.forEach(weekend => {
                message += `- ${weekend}\n`;
            });
            message += `\nElijan sabiamente y eviten llamar a Guille...\n\n`;
            message += `Atentamente,\nSibi`;

            const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        }
        
        function sendHelpMessage() {
            let message = `¬°Siniestras! Emergencia de agenda üÜò\n\nNinguno de los fines de semana de Octubre/Noviembre me sirve para la experiencia.\n\n¬°Necesito m√°s opciones! Activen el plan B.`;
            const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        }
        
        // Iniciar el juego
        renderScreen(currentScreen);
    </script>

</body>
</html>